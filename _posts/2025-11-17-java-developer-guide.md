---
layout: post
title: "Java 开发手册（黄山版）"
category: Java
---


# Java 开发手册（黄山版）

## 前言

《Java 开发手册》是 Java 社区爱好者的集体智慧结晶和经验总结，经历了多次大规模一线实战的检验及不断完善，整理成册后，众多社区开发者踊跃参与打磨完善，系统化地整理成册，当前的最新版本是黄山版。现代软件行业的高速发展对开发者的综合素质要求越来越高，因为不仅是编程知识点，其它维度的知识点也会影响到软件的最终交付质量。比如：五花八门的错误码会人为地增加排查问题的难度；数据库的表结构和索引设计缺陷带来的系统架构缺陷或性能风险；工程结构混乱导致后续项目维护艰难；没有鉴权的漏洞代码容易被黑客攻击等。所以本手册以 Java 开发者为中心视角，划分为编程规约、异常日志、单元测试、安全规约、MySQL 数据库、工程结构、设计规约七个维度，再根据内容特征，细分成若干二级子目录。此外，依据约束力强弱及故障敏感性，规约依次分为【强制】、【推荐】、【参考】三大类。在延伸的信息中，“说明”对规约做了适当扩展和解释；“正例”提倡什么样的编码和实现方式；“反例”说明需要提防的雷区，以及真实的错误案例。

手册的愿景是码出高效，码出质量。现代软件架构的复杂性需要协同开发完成，如何高效地协同呢？无规矩不成方圆，无规范难以协同，比如，制定交通法规表面上是要限制行车权，实际上是保障公众的人身安全，试想如果没有限速，没有红绿灯，谁还敢上路行驶？对软件来说，适当的规范和标准绝不是消灭代码内容的创造性、优雅性，而是限制过度个性化，以一种普遍认可的统一方式一起做事，提升协作效率，降低沟通成本。代码的字里行间流淌的是软件系统的血液，代码质量的提升是尽可能少踩坑，杜绝踩重复的坑，切实提升系统稳定性，码出质量。

## 目录

1. [编程规约](#编程规约)
    - [命名风格](#命名风格)
    - [常量定义](#常量定义)
    - [代码格式](#代码格式)
    - [OOP 规约](#OOP-规约)
    - [日期时间](#日期时间)
    - [集合处理](#集合处理)
    - [并发处理](#并发处理)
    - [控制语句](#控制语句)
    - [注释规约](#注释规约)
    - [前后端规约](#前后端规约)
    - [其他](#其他)
2. [异常日志](#异常日志)
    - [错误码](#错误码)
    - [异常处理](#异常处理)
    - [日志规约](#日志规约)
3. [单元测试](#单元测试)
4. [安全规约](#安全规约)
5. [MySQL 数据库](#MySQL-数据库)
    - [建表规约](#建表规约)
    - [索引规约](#索引规约)
    - [SQL 语句](#SQL-语句)
    - [ORM 映射](#ORM-映射)
6. [工程结构](#工程结构)
    - [应用分层](#应用分层)
    - [二方库依赖](#二方库依赖)
    - [服务器](#服务器)
7. [设计规约](#设计规约)

## 一、编程规约

### (一) 命名风格

1. 【强制】所有编程相关的命名均不能以下划线或美元符号开始，也不能以下划线或美元符号结束。
    - 反例：_name / __name / $Object / name_ / name$ / Object$
    - 正例：name / userName / objectName

2. 【强制】所有编程相关的命名严禁使用拼音与英文混合的方式，更不允许直接使用中文的方式。
    - 反例：DaZhePromotion【打折】/ getPingfenByName()【评分】

3. 【强制】代码和注释中都要避免使用任何人类语言中的种族歧视性或侮辱性词语。
    - 正例：blockList / allowList / secondary
    - 反例：blackList / whiteList / slave

4. 【强制】类名使用 UpperCamelCase 风格，以下情形例外：DO / PO / DTO / BO / VO / UID 等。
    - 正例：ForceCode / UserDO / HtmlDTO
    - 反例：forcecode / UserDo / HTMLDto

### (二) 常量定义

1. 【强制】不允许任何魔法值（即未经预先定义的常量）直接出现在代码中。
    - 反例：`String key = "Id#taobao_" + tradeId;`
2. 【强制】long 或 Long 赋值时，数值后使用大写 L，不能是小写 l。
    - 正例：`public static final Long NUM = 2L;`
    - 反例：`public static final Long NUM = 2l;`
3. 【强制】浮点数类型的数值后缀统一为大写的 D 或 F。
    - 正例：`public static final double HEIGHT = 175.5D;`
4. 【推荐】不要使用一个常量类维护所有常量，要按常量功能进行归类，分开维护。
    - 正例：`缓存相关常量放在类 CacheConsts 下；系统配置相关常量放在类 SystemConfigConsts 下；`

### (三) 代码格式

1. 【强制】如果大括号内为空，简洁地写成`{}`即可，大括号中间无需换行和空格；如果是非空代码块，则左大括号前不换行，左大括号后换行。
    - 正例：
      ```java
      if (condition) {
          // code
      }
      ```
2. 【强制】左小括号和右边相邻字符之间不需要空格；右小括号和左边相邻字符之间也不需要空格；而左大括号前需要加空格。
3. 【强制】采用 4 个空格缩进，禁止使用 Tab 字符。
4. 【强制】注释的双斜线与注释内容之间有且仅有一个空格。
    - 正例：`// 这是示例注释，请注意在双斜线之后有一个空格`

## 二、异常日志

### (一) 错误码

1. 【强制】错误码要具有明确的定义，避免使用过于通用的错误码。
    - 反例：`ERR01`（不明确错误类型）
    - 正例：`INVALID_USER_INPUT`

### (二) 异常处理

1. 【强制】使用具体的异常类型，避免使用通用异常。
    - 反例：`catch (Exception e)`
    - 正例：`catch (FileNotFoundException e)`

## 三、单元测试

1. 【强制】所有关键业务功能都需要编写单元测试，并使用适当的断言方法验证结果。
2. 【推荐】单元测试代码要简洁、易懂，测试用例应覆盖所有边界情况。

## 四、安全规约

1. 【强制】所有敏感数据必须加密存储，包括用户密码、支付信息等。
2. 【推荐】尽量避免硬编码密钥和敏感信息，使用环境变量或配置文件代替。

## 五、MySQL 数据库

### (一) 建表规约

1. 【强制】表的字段必须使用明确的类型，避免使用不明确的 `TEXT` 类型。
2. 【强制】字段命名应采用小写字母，使用下划线分隔。
    - 正例：`user_id`, `user_name`

### (二) 索引规约

1. 【强制】重要查询字段需要建立索引，但不宜为所有字段建立索引。
2. 【推荐】使用复合索引优化多字段查询的性能。

## 六、工程结构

### (一) 应用分层

1. 【强制】项目采用分层架构，保证各层职责清晰，减少耦合。
2. 【推荐】在 `service` 层处理业务逻辑，在 `dao` 层进行数据库操作。

## 七、设计规约

1. 【强制】设计模式应在合适的地方使用，避免过度设计。
2. 【推荐】所有的类和方法应有明确的职责，避免功能过于复杂。

---

### 附 1：版本历史

1. **1.7.1** - 全球 Java 社区开发者 - 2022.02.03 - 黄山版，新增 11 条新规约。

### 附 2：专有名词解释

**POJO**：Plain Old Java Object 简单的 Java 对象。

**DTO**：Data Transfer Object 数据传输对象。

### 附 3：错误码列表

```text
10001: 用户未登录
10002: 用户权限不足
10003: 数据库连接失败
```
